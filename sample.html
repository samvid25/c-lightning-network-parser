<html>
  <head>
    <title>SigmaJS example</title>
    <script src="sigma.min.js"></script>
    <script src="jquery-2.1.0.min.js"></script>
    <script src="sigma.plugins.relativeSize.min.js"></script>
    <style>
      html { height:100%;}
      body {height: 100%;}
      #sigma-container { width:100%; height:100%; background-color:#E1E1E1}
    </style>
  </head>
  <body>
    <div id='sigma-container'></div>
    <script>
      
    nodes_jsondata = { "nodes" : 
  [ 
    { "nodeid" : "n1", "alias" : "???? EXANTE", "color" : "007f39", "last_timestamp" : 1516636793, "addresses" : 
      [ 
        { "type" : "ipv4", "address" : "148.251.53.235", "port" : 9735 } ] }, 
    { "nodeid" : "n2", "alias" : "WEIRDARK", "color" : "03867d", "last_timestamp" : 1516844101, "addresses" : 
      [  ] }, 
    { "nodeid" : "n3", "alias" : "EksiSozlukLN", "color" : "316293", "last_timestamp" : 1517650435, "addresses" : 
      [ 
        { "type" : "ipv4", "address" : "188.166.88.130", "port" : 9735 } ] }, 
    { "nodeid" : "n4", "alias" : "fenixxF0x9Fx8Cx9F", "color" : "02a0b3", "last_timestamp" : 1518735722, "addresses" : 
      [ 
        { "type" : "ipv4", "address" : "178.62.85.122", "port" : 9735 } ] }, 
    { "nodeid" : "n5", "alias" : "LXPARALLEL", "color" : "000000", "last_timestamp" : 1518977083, "addresses" : 
      [ 
        { "type" : "ipv6", "address" : "2001:8a0:4126:ce01:495b:291:f370:62f1", "port" : 9735 } ] }
     ]}













  channels_jsondata = 
  { "channels" : 
  [ 
    { "source" : "n2", "destination" : "n1", "short_channel_id" : "505198:1139:1", "flags" : 0, "active" : true, "public" : true, "last_update" : 1516847709, "base_fee_millisatoshi" : 546000, "fee_per_millionth" : 10, "delay" : 14 }, 
    { "source" : "n2", "destination" : "n4", "short_channel_id" : "505206:1066:1", "flags" : 0, "active" : true, "public" : true, "last_update" : 1516636771, "base_fee_millisatoshi" : 546000, "fee_per_millionth" : 10, "delay" : 14 }, 
    { "source" : "n2", "destination" : "n5", "short_channel_id" : "505207:2408:1", "flags" : 0, "active" : true, "public" : true, "last_update" : 1516864360, "base_fee_millisatoshi" : 546000, "fee_per_millionth" : 10, "delay" : 14 }, 
    { "source" : "n1", "destination" : "n2", "short_channel_id" : "505718:1204:0", "flags" : 1, "active" : false, "public" : true, "last_update" : 1516729607, "base_fee_millisatoshi" : 546000, "fee_per_millionth" : 10, "delay" : 14 }, 
    { "source" : "n5", "destination" : "n2", "short_channel_id" : "505809:539:0", "flags" : 0, "active" : true, "public" : true, "last_update" : 1516767952, "base_fee_millisatoshi" : 546000, "fee_per_millionth" : 10, "delay" : 14 },
    { "source" : "n3", "destination" : "n5", "short_channel_id" : "505809:539:0", "flags" : 0, "active" : true, "public" : true, "last_update" : 1516767952, "base_fee_millisatoshi" : 546000, "fee_per_millionth" : 10, "delay" : 14 },
    { "source" : "n4", "destination" : "n5", "short_channel_id" : "505809:539:0", "flags" : 0, "active" : true, "public" : true, "last_update" : 1516767952, "base_fee_millisatoshi" : 546000, "fee_per_millionth" : 10, "delay" : 14 }
    ]}
    


      nodes_json = nodes_jsondata["nodes"];
      channels_json = channels_jsondata["channels"];
      console.log(nodes_json.length);

      // Initialise sigma:
      var s = new sigma(
        {
          renderer: {
            container: document.getElementById('sigma-container'),
            type: 'canvas'
          },
          settings: {
            minArrowSize: 10
          }
        }
      );

      
      // Generate a random graph:
      var nbNode = 621;
      var nbEdge = 3804;
      var graph = {
        nodes: [],
        edges: []
      };
      for (i = 0; i < nodes_json.length; i++)
        graph.nodes.push({ 
          id:  nodes_json[i]["nodeid"],
          label: "n" + i,
          x: (i%5)*100,
          y: (i%2)*100,
          size: 0.01,
          color: '#EE651D'
        });

      for (i = 0; i < channels_json.length; i++)
        graph.edges.push({ 
          //id: channels_json[i]["short_channel_id"], 
          id: i,
          source: "" + channels_json[i]["source"], 
          target: "" + channels_json[i]["destination"],
          color: '#202020',
          type: 'curvedArrow'
        });

      //init();
      // load the graph
      s.graph.read(graph);

      sigma.plugins.relativeSize(s, 2);
      // draw the graph
      s.refresh();
      // launch force-atlas for 5sec
      s.startForceAtlas2();
      window.setTimeout(function() {s.killForceAtlas2()}, 10000);
      //init();
      
    </script>



  </body>
</html>